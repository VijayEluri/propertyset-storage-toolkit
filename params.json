{"name":"Propertyset-storage-toolkit","body":"# README\r\n\r\n## Disclaimer\r\nIn case all you need is to store global or project-level configuration - then you definitely should take look into [SAL PluginSettings](http://confluence.atlassian.com/display/SAL/SAL+Services#SALServices-%21package2.gif%21%7B%7Bcom.atlassian.sal.api.pluginsettings%7D%7D).\r\n\r\n## Description\r\nThe toolkit is a set of utilities to access, look up and store [OpenSymphony's PropertySet](http://www.opensymphony.com/propertyset/) data. The thing is - no one really knows what's the best and the most painless process to store JIRA items configuration, let's say for your **__plug-in A__** at both plug-in and Project levels.\r\nThe purpose and the intent of this project is to provide You as Plug-in developer with the toolkit and ready to use samples and snippets to choose from to make thing work. \r\n\r\nAs the project name states - it uses PropertySet as underlying storage implementation. It might not be the best choice for every plug-in out there in the wild world, still it's rather usable for most use cases I had so far.\r\n\r\n## Compatibility\r\nThe plugin is developed as JIRA Atlassian Plugin v2. This limits it's usage to JIRA > 4x.\r\nOn the other hand - it does not have any dependency on new stuff and should work correctly in JIRA 3xml as well (needs adjustments).\r\nPlease inform me if you would try to modify it for earlier versions.\r\n\r\n## Feature Overview\r\n- Database persistence using [PropertySet](http://www.opensymphony.com/propertyset/) for underlying data storage\r\n- Has no additional JIRA dependencies and provides enhanced PropertySet API sub-set\r\n- Could be used both as JAR dependency bundled with your plugin OR as separate plugin, depending one your current needs.\r\n- Provides a rich set of out-of box list of _Scope_ objects. (_Scope_ defines the sandbox of the PropertySet storage instance). At\r\n the moment following configuration options are supported\r\n  1. Named configuration scope (Example: My Gadget1 Configuration)\r\n  1. Action configuration scope (Example: your plugin may contain _Administration_ action,\r\nwhich may require to persist and access administrator input).\r\n  1. Project configuration scope (Example: you may associate configuration information with project object)\r\n  1. Issue configuration scope (Example: you may associate configuration information with issue object)\r\n- The list of scopes is not limited and you may come-up with your own _Scope_\r\n\r\n## Sample Code\r\n\r\n#### 1. Action persistence in action\r\n\r\n     private final StorageService storageService; // IoC by framework via Constructor Dependency Injection\r\n     ...\r\n\r\n     // data fields\r\n     private boolean adminOnly;\r\n     private String helloText;\r\n     private String welcomeText;\r\n\r\n     private StorageFacade getStorage()\r\n     {\r\n         return storageService.actionStorage(this);\r\n     }\r\n\r\n    \r\n     private void loadConfig(StorageFacade storage)\r\n     {\r\n         setAdminOnly(storage.getBoolean(ADMIN_ONLY));\r\n         setHelloText(StringUtils.defaultString(storage.getString(HELLO_TEXT), \"Hello, \"));\r\n         setWelcomeText(StringUtils.defaultString(storage.getString(WELCOME_TEXT), \"World\"));\r\n     }\r\n\r\n     private void saveConfig(StorageFacade storage)\r\n     {\r\n         storage.setBoolean(ADMIN_ONLY, isAdminOnly());\r\n         storage.setString(HELLO_TEXT, getHelloText());\r\n         storage.setString(WELCOME_TEXT, getWelcomeText());\r\n     }\r\n\r\n#### 2. DTO Object data persistence\r\n    // class I want to save as My configuration data holder\r\n    private static class MySerializable implements Serializable\r\n    {\r\n        private String text;\r\n        private Long number;\r\n        private Map<String, String> mapping;\r\n        \r\n        ...\r\n        getters, setters\r\n        ...\r\n        hashCode, equals\r\n    }\r\n\r\n\r\n    @ToolkitTest\r\n    protected void constantScopeSaveDeleteForObject() throws Exception\r\n    {\r\n        String name = getClass().getName() + \"-saveDeleteCycle\";\r\n        StorageFacade facade = storageService.constantNameStorage(name);\r\n        facade.remove(\"object\");\r\n\r\n        MySerializable object = new MySerializable(10L, \"data data\", \r\n            Maps.<String, String>newHashMap(ImmutableMap.of(\"1\", \"data1\", \"sdsd\", \"data2\")));\r\n        stateTrue(\"First object access should be null\", facade.getObject(\"object\") == null);\r\n        facade.setObject(\"object\", object);\r\n        stateTrue(\"object key should exist now\", facade.exists(\"object\"));\r\n        stateTrue(\"\" + object + \"=\" + facade.getObject(\"object\"), facade.getObject(\"object\").equals(object));\r\n        facade.setObject(\"object\", null);\r\n        not(\"object key should NOT exist now\", facade.exists(\"object\"));\r\n\r\n        facade.setObject(\"object\", object);\r\n        stateTrue(\"long key should exist now\", facade.exists(\"object\"));\r\n        stateTrue(\"delete object should work\", facade.remove(\"object\"));\r\n        not(\"long key should NOT exist now\", facade.exists(\"object\"));\r\n    }\r\n\r\n## How do I get started?\r\n\r\nAs you may notice, the project code consists from two separate and completely valid Atlassian JIRA plugins. It contains the persistence\r\ntoolkit itself as well as simple samples application with bundled-integration test and WebWork configurable action in action.\r\n\r\nYou may proceed as it follows:\r\n\r\n- Get the sources (if you are unfamiliar with Git or Github, help is [here](http://help.github.com/))\r\n- If you still don't have Atlassian PDK installed - you probably are reading wrong README then. (it's [out there](http://confluence.atlassian.com/display/DEVNET/Developing+your+Plugin+using+the+Atlassian+Plugin+SDK)). I used atlassian-plugin-sdk-3.2.3 at the moment of writing.\r\n- Launch the terminal and `cd` to propertyset-storage-toolkit-sample folder\r\n- Execute the following command\r\n\r\n      atlas-mvn -f ../propertyset-storage-toolkit/pom.xml clean package install \\\r\n        && atlas-mvn clean                                                      \\\r\n        && atlas-integration-test --plugins \\\r\n           \"com.atlassian.plugins.studio.propertyset.storage:propertyset-storage-toolkit:1.0-SNAPSHOT\" \\\r\n        && atlas-debug --plugins \\\r\n           \"com.atlassian.plugins.studio.propertyset.storage:propertyset-storage-toolkit:1.0-SNAPSHOT\"\r\n- Wait\r\n\r\nThe command above will compile and install into the local repository propertyset-storage-toolkit plugin artifact,\r\nthen it will test it and launch sample application.\r\n\r\n## Sample Application Tutorial\r\n\r\nIf you succeed with the steps above - then you have proceed and open http://localhost:2990/jira/ link. You will notice new dropdown Menu Item \"PropertySet Toolkit\". Menu items descriptions:\r\n\r\n- Integration Test Results - link to servlet with integration test data (servlet executes test suite and provides the execution summary).\r\n- Manual - link to documentation (More to come)\r\n- Configurable Action Example - Sample [WebWork Plugin Module](http://confluence.atlassian.com/display/JIRA/Webwork+plugin+module) with configuration persistence enabled.\r\n\r\n\r\n## Installation as separate plugin\r\nSee [Managing Jira's Plug-ins ](http://confluence.atlassian.com/display/JIRA/Managing+JIRA's+Plugins) page for more details.\r\n\r\n\r\n## How-To Recipes\r\n.. TDB .. Now we are cooking, more to come.\r\n","tagline":"Opensymhony PropertySet storage toolkit for Atlassian JIRA ","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}